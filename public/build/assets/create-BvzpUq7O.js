import{d as D,s as m,r as E,f as G,g as P,i as I,c as i,o as n,a,u as o,h as T,w as l,b as r,j as q,e as c,F as _,k as F,t as S,m as A}from"./app-MbwmxENq.js";import{_ as L}from"./AppLayout.vue_vue_type_script_setup_true_lang-ChnGhnGT.js";import{u as M,a as g,_ as O,b as R,c as W,d as z}from"./FormMessage.vue_vue_type_script_setup_true_lang-B81r2i96.js";import{t as H}from"./vee-validate-zod-C-Y2Lq6T.js";import{_ as J,g as K}from"./_schema-D0fQBxrP.js";import{_ as C}from"./index-CHp6LXy2.js";import{t as k}from"./index-BxdJrSRa.js";import{u as Q}from"./index-DQ1F4Mgb.js";import{_ as X}from"./_Form.vue_vue_type_script_setup_true_lang-B8oKrote.js";import"./Primitive-mDfYgi-U.js";import"./index-oP4qFRLE.js";import"./VisuallyHidden-CBhFKQtd.js";import"./useId-BA1mJUwU.js";import"./index-CHXQtOYb.js";import"./Label.vue_vue_type_script_setup_true_lang-BMql7QJ1.js";import"./Input.vue_vue_type_script_setup_true_lang-mF2s47O3.js";import"./EquirectangularPicker.vue_vue_type_script_setup_true_lang-GlrGm7nG.js";const Y={class:"p-4"},Z=["value","onChange"],ee=["value"],te={class:"space-y-3"},oe={key:0,class:"grid grid-cols-2 gap-3 md:grid-cols-4"},se=["src"],ae={class:"pt-2"},Se=D({__name:"create",props:{photospheres:{}},setup(w){const $=w,x=[{title:"Admin",href:m("admin")},{title:"Galleries",href:m("admin.gallery.index")}],{handleSubmit:V}=M({validationSchema:H(K)}),N=g("photosphere_id"),h=g("latitude"),v=g("longitude"),d=E([]),U=G(()=>{const t=N.value.value,e=t?Number(t):null;return e?m("photosphere.image",e):null});function j(t){for(const e of t)e.type.startsWith("image/")&&d.push(e)}function B(t){d.splice(t,1)}const y=V(t=>{const e=new FormData;e.append("photosphere_id",String(t.photosphere_id)),e.append("name",t.name),t.latitude!==void 0&&e.append("latitude",String(t.latitude)),t.longitude!==void 0&&e.append("longitude",String(t.longitude)),d.forEach((f,s)=>e.append(`photos[${s}]`,f)),P.post(m("api.v1.gallery.store"),e,{forceFormData:!0,onSuccess:()=>k.success("Gallery created"),onError:()=>k.error("Validation failed")})});return(t,e)=>{const f=I("FormField");return n(),i(_,null,[a(o(T),{title:"Create Gallery"}),a(L,{breadcrumbs:x},{default:l(()=>[r("div",Y,[e[8]||(e[8]=r("div",{class:"py-3"},[r("h1",{class:"mr-3 inline py-3 text-xl"},"New gallery")],-1)),r("form",{class:"mt-4 max-w-3xl space-y-6",onSubmit:e[2]||(e[2]=q((...s)=>o(y)&&o(y)(...s),["prevent"]))},[a(X,{"picker-src":U.value,lat:o(h).value.value??null,lon:o(v).value.value??null,"onUpdate:lat":e[0]||(e[0]=s=>o(h).setValue(s)),"onUpdate:lon":e[1]||(e[1]=s=>o(v).setValue(s))},{before:l(()=>[a(f,{name:"photosphere_id"},{default:l(({value:s,handleChange:p,errorMessage:b})=>[a(o(O),null,{default:l(()=>[a(o(R),null,{default:l(()=>e[3]||(e[3]=[c("Photosphere",-1)])),_:1,__:[3]}),a(o(W),null,{default:l(()=>[r("select",{class:"w-full rounded-md border p-2",value:s??"",onChange:u=>p(u.target.value)},[e[4]||(e[4]=r("option",{value:""},"Selectâ€¦",-1)),(n(!0),i(_,null,F($.photospheres,u=>(n(),i("option",{key:u.id,value:String(u.id)},S(u.name),9,ee))),128))],40,Z)]),_:2},1024),a(o(z),null,{default:l(()=>[c(S(b),1)]),_:2},1024)]),_:2},1024)]),_:1})]),_:1},8,["picker-src","lat","lon"]),r("div",te,[e[6]||(e[6]=r("div",{class:"text-sm font-medium"},"Photos",-1)),a(J,{multiple:"",accept:"image/*",onFiles:j}),d.length?(n(),i("div",oe,[(n(!0),i(_,null,F(d,(s,p)=>(n(),i("div",{key:p,class:"space-y-2 rounded border p-2"},[r("img",{src:o(Q)(s).value,alt:"",class:"aspect-square w-full rounded object-cover"},null,8,se),a(o(C),{type:"button",variant:"destructive",class:"w-full",onClick:b=>B(p)},{default:l(()=>e[5]||(e[5]=[c(" Remove ",-1)])),_:2,__:[5]},1032,["onClick"])]))),128))])):A("",!0)]),r("div",ae,[a(o(C),{type:"submit"},{default:l(()=>e[7]||(e[7]=[c("Create gallery",-1)])),_:1,__:[7]})])],32)])]),_:1})],64)}}});export{Se as default};
//# sourceMappingURL=create-BvzpUq7O.js.map
